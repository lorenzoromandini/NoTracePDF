---
phase: 01-mvp-foundation
plan: 07
type: execute
wave: 3
depends_on: [01-03, 01-04, 01-05, 01-06]
files_modified: []
autonomous: true
requirements: [UI-01, UI-02, UI-03, UI-04, UI-05, UI-06, UI-07, UI-08]

must_haves:
  truths:
    - "User sees clean, modern web UI with tool cards in grid layout"
    - "User can drag and drop files to upload"
    - "User sees tool-specific options panels"
    - "User sees real-time progress during processing"
    - "User gets instant download after processing"
    - "User sees 'files deleted' confirmation after download"
    - "No history, no recent files, no tracking cookies"
    - "UI works on mobile devices"
  artifacts:
    - path: "app/static/index.html"
      provides: "Single-page web application"
      contains: "tool grid"
    - path: "app/static/css/styles.css"
      provides: "Styling with responsive design"
      contains: "@media"
    - path: "app/static/js/app.js"
      provides: "Application logic"
      exports: ["uploadFiles", "downloadResult"]
    - path: "app/main.py"
      provides: "Static file serving"
      contains: "StaticFiles"
  key_links:
    - from: "app/static/js/app.js"
      to: "/api/v1/*"
      via: "fetch API calls"
      pattern: "fetch.*api/v1"
    - from: "app/main.py"
      to: "app/static"
      via: "StaticFiles mount"
      pattern: "StaticFiles.*static"
---

<objective>
Create a clean, modern web UI with drag-and-drop upload, real-time progress, and instant download. No history, no tracking, responsive design.

Purpose: The UI is how users interact with the PDF toolkit. Must be intuitive, fast, and reinforce the privacy guarantee with clear messaging.

Output: Complete single-page web application serving all PDF and image conversion features.
</objective>

<execution_context>
@/home/ubuntu/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/ubuntu/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create HTML structure with tool grid layout</name>
  <files>
    app/static/index.html
    app/main.py
  </files>
  <action>
    Create the main HTML page with tool cards:

    1. Create `app/static/index.html`:
       - Modern HTML5 structure
       - Head with meta tags for privacy:
         - No browser tracking
         - Responsive viewport
       - Tool grid layout with cards for each tool:
         - Merge PDF
         - Split PDF
         - Rotate PDF
         - Compress PDF
         - Password Protect
         - Remove Password
         - Add Watermark (text/image)
         - Extract Text
         - Extract Images
         - Extract Pages
         - PDF to Images
         - Images to PDF
       - Each card has:
         - Icon (use inline SVG for zero external requests)
         - Title
         - Brief description
         - Click to open tool modal

    2. Update `app/main.py`:
       - Mount static files: app.mount("/", StaticFiles(directory="app/static", html=True), name="static")
       - Route / to index.html

    3. Include privacy messaging:
       - Header: "NoTracePDF - Your files never leave your device"
       - Footer: "Zero persistence. Zero tracking. 100% private."

    Reference UI-01: Clean, modern, single-page web UI with tool cards in grid layout.
  </action>
  <verify>
    test -f app/static/index.html && grep -q "tool-card" app/static/index.html && grep -q "StaticFiles" app/main.py
  </verify>
  <done>
    - HTML page exists with tool grid
    - 12 tool cards displayed
    - Static files mounted in FastAPI
    - Privacy messaging present
  </done>
</task>

<task type="auto">
  <name>Task 2: Create responsive CSS with modern styling</name>
  <files>
    app/static/css/styles.css
  </files>
  <action>
    Create responsive stylesheet:

    1. Create `app/static/css/styles.css`:
       - CSS variables for consistent theming:
         - --primary-color: #2563eb (blue)
         - --background: #f8fafc
         - --text: #1e293b
         - --card-bg: white
         - --border: #e2e8f0
       - Layout:
         - Grid for tool cards (3-4 columns on desktop, 2 on tablet, 1 on mobile)
         - Flexbox for centering
       - Components:
         - Tool cards with hover effects
         - Modal for tool interface
         - Drag-and-drop zone
         - Progress bar
         - Buttons (primary, secondary, disabled states)
       - Responsive breakpoints:
         - Desktop: 1024px+ (4 columns)
         - Tablet: 768px-1023px (2 columns)
         - Mobile: <768px (1 column, stacked layout)
       - Animations:
         - Subtle hover transitions
         - Progress bar animation
         - Fade in/out for modals

    2. No external font requests:
       - Use system font stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif

    3. Dark mode support (via prefers-color-scheme):
       - Optional enhancement for future

    Reference UI-01, UI-08: Modern UI with responsive design.
  </action>
  <verify>
    test -f app/static/css/styles.css && grep -q "@media" app/static/css/styles.css && grep -q "tool-card" app/static/css/styles.css
  </verify>
  <done>
    - CSS file exists with responsive grid
    - Media queries for mobile/tablet/desktop
    - Tool cards have hover effects
    - System fonts used (no external requests)
  </done>
</task>

<task type="auto">
  <name>Task 3: Implement drag-and-drop file upload with validation</name>
  <files>
    app/static/js/app.js
    app/static/js/upload.js
  </files>
  <action>
    Create file upload functionality:

    1. Create `app/static/js/upload.js`:
       - DragDropHandler class:
         - Initialize drop zone element
         - Handle dragenter, dragover, dragleave, drop events
         - Visual feedback during drag
         - Prevent default browser behavior
       - File validation:
         - Check file types (PDF, images)
         - Check file sizes against limit
         - Display errors inline
       - File list management:
         - Display selected files
         - Allow removal
         - Reorder for merge operations

    2. Create `app/static/js/app.js`:
       - Main application class
       - Initialize upload handlers
       - Tool state management

    3. Upload zone features:
       - Dashed border when empty
       - Highlight on drag over
       - List of selected files with remove buttons
       - File size display
       - Multiple file support for merge

    Reference UI-02: Drag and drop upload zone supporting multiple files.
  </action>
  <verify>
    test -f app/static/js/upload.js && test -f app/static/js/app.js && grep -q "drag" app/static/js/upload.js
  </verify>
  <done>
    - Drag and drop works in upload zone
    - File type validation shows errors
    - File size validation shows errors
    - Multiple files can be selected
    - Files can be removed before upload
  </done>
</task>

<task type="auto">
  <name>Task 4: Implement tool-specific options panels</name>
  <files>
    app/static/js/app.js
    app/static/js/tools.js
  </files>
  <action>
    Create tool configuration interfaces:

    1. Create `app/static/js/tools.js`:
       - Tool configuration object defining each tool:
         - Endpoint URL
         - Required parameters
         - Optional parameters
         - File requirements (single/multiple, types)
       - Option panel generators for each tool:
         - Merge: file order controls
         - Split: mode selector (range, every N, specific pages), page inputs
         - Rotate: page selector (all/specific), degree buttons (90/180/270)
         - Compress: quality radio buttons (low/medium/high)
         - Password: password input, permission checkboxes
         - Watermark: text input OR image upload, position selector, opacity slider
         - Extract: extraction type selector, page range

    2. Dynamic form generation:
       - Show appropriate options based on selected tool
       - Validate inputs before submit
       - Collect all parameters for API call

    3. Update HTML with option panel container:
       - Modal that shows tool options after file selection

    Reference UI-03: Tool-specific options panel.
  </action>
  <verify>
    test -f app/static/js/tools.js && grep -q "compress" app/static/js/tools.js && grep -q "watermark" app/static/js/tools.js
  </verify>
  <done>
    - Each tool has appropriate options UI
    - Split tool has range, every N, specific pages options
    - Compress tool has quality presets
    - Watermark tool has text/image option, position, opacity
    - All options collected for API submission
  </done>
</task>

<task type="auto">
  <name>Task 5: Implement real-time progress and download handling</name>
  <files>
    app/static/js/api.js
    app/static/js/app.js
  </files>
  <action>
    Create API interaction with progress feedback:

    1. Create `app/static/js/api.js`:
       - submitJob function:
         - Build FormData from files and options
         - POST to appropriate endpoint
         - Track upload progress via XMLHttpRequest.upload.onprogress
         - Return Promise with response
       - downloadFile function:
         - Handle blob response
         - Create download link
         - Trigger download with filename
         - Clean up blob URL after download
       - Error handling:
         - Parse error responses
         - Display user-friendly error messages

    2. Update `app/static/js/app.js`:
       - Progress bar component:
         - Show during upload and processing
         - Update percentage display
         - Indeterminate state for server processing
       - Download handling:
         - Clear progress bar
         - Show success message
         - Trigger file download
         - Show "files deleted" confirmation

    3. Progress indication:
       ```javascript
       // Upload progress
       xhr.upload.onprogress = (e) => {
         const percent = (e.loaded / e.total) * 100;
         updateProgressBar(percent);
       };
       ```

    Reference UI-04, UI-05, UI-06: Real-time progress, instant download, deletion confirmation.
  </action>
  <verify>
    test -f app/static/js/api.js && grep -q "onprogress" app/static/js/api.js && grep -q "download" app/static/js/api.js
  </verify>
  <done>
    - Upload progress shows percentage
    - Processing shows indeterminate progress
    - Download triggers automatically after success
    - "Files deleted" message appears after download
    - Error messages display for failed operations
  </done>
</task>

<task type="auto">
  <name>Task 6: Implement privacy-first session handling</name>
  <files>
    app/static/js/app.js
    app/static/index.html
  </files>
  <action>
    Ensure zero tracking and no persistent data:

    1. Update `app/static/js/app.js`:
       - Clear all state after download:
         - Reset file list
         - Reset tool selection
         - Clear any temporary data
       - No localStorage usage for user files
       - No sessionStorage for file content
       - Optional: localStorage for UI preferences only (theme)

    2. Update `app/static/index.html`:
       - Add meta tags:
         ```html
         <meta name="robots" content="noindex, nofollow">
         <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
         ```

    3. Implement "files deleted" confirmation:
       - After successful download:
         - Show prominent message: "Your files have been permanently deleted from the server"
         - Reset UI to initial state
         - Clear any file references

    4. No cookies except optional UI preference:
       - Only store non-sensitive UI state
       - No tracking cookies
       - No session IDs

    Reference UI-06, UI-07: Deletion confirmation, no history/tracking.
  </action>
  <verify>
    grep -q "localStorage" app/static/js/app.js && echo "Check localStorage usage is minimal" || echo "No localStorage usage"
    grep -q "deleted" app/static/js/app.js && grep -q "permanently" app/static/js/app.js
  </verify>
  <done>
    - UI resets completely after download
    - No file content stored in browser storage
    - "Files deleted" confirmation shows
    - No tracking cookies
    - No session history
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Open browser to http://localhost:8000
2. Verify tool grid displays correctly
3. Test drag and drop file upload
4. Select a tool and verify options appear
5. Run an operation and verify progress shows
6. Verify download triggers automatically
7. Verify "files deleted" message appears
8. Test on mobile viewport (responsive design)
</verification>

<success_criteria>
- Clean, modern UI with tool cards in grid layout
- Drag-and-drop upload works
- Tool-specific options display correctly
- Real-time progress shows during processing
- Instant download after success
- "Files deleted" confirmation displays
- No history, no tracking, no persistent cookies
- Responsive design works on mobile
- Requirements UI-01 to UI-08 implemented
</success_criteria>

<output>
After completion, create `.planning/phases/01-mvp-foundation/01-07-SUMMARY.md`
</output>
